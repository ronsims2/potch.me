<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>potch dot me | Click and Drag Press and Hold</title>
    <link rel="stylesheet/less" type="text/css" href="/blog/media/all.css">
  </head>
  <body>
    <header>
      <h1><a href="https://twitter.com/potch">potch</a>.<a href="http://potch.me">me</a></h1>
    </header>
    
  <article>
    <h1><s>Click and Drag</s> Press and Hold</h1>

    <p>I really loved <a href="https://www.xkcd.com/1110/">today's xkcd, "Click and Drag"</a>,
    but couldn't bring myself to spend that much time on my tiny trackpad,
    well, clicking and dragging. Never one to demur to the challenge of
    allowing myself future laziness, I wrote the following code to let me move
    around the incredible illustrated world with my keyboard. Faking mouse
    events FTW!</p>

    <p>Just copy and paste the code into your browser's JavaScript console to
    play!</p>

    <p>Here's the below code as a bookmarklet: <code><a href='javascript:function fakeMouseEvent(e,t,n){var r=document.createEvent("MouseEvents");r.initMouseEvent(e,!0,!0,window,0,0,0,t,n,!1,!1,!1,!1,0,null),el.dispatchEvent(r)}var el=$(".map")[0],move=200;$(window).keydown(function(e){var t=e.which;if(t>=37&&t<=40){e.preventDefault();var n=0,r=0;t==37&&(n+=move),t==38&&(r+=move),t==39&&(n-=move),t==40&&(r-=move),fakeMouseEvent("mousedown",0,0),setTimeout(function(){fakeMouseEvent("mousemove",n,r),setTimeout(function(){fakeMouseEvent("mouseup",n,r)},0)},0)}});undefined;'>Press and Hold</a></code></p>

    <pre><code>
// get the map element
var el = $('.map')[0];

// amount in pixels we want to move each keypress/hold
var move = 200;

function fakeMouseEvent(type, x, y) {
    var evt = document.createEvent("MouseEvents");
    evt.initMouseEvent(type, true, true, window,
                       0, 0, 0, x, y, false, false, false, false, 0, null);
    el.dispatchEvent(evt);
}

$(window).keydown(function(e) {
    var key = e.which;
    if (key >= 37 && key &lt;= 40) {
        e.preventDefault();
        var left=0, top=0;
        if (key == 37) { left += move; }
        if (key == 38) { top += move; }
        if (key == 39) { left -= move; }
        if (key == 40) { top -= move; }
        fakeMouseEvent('mousedown', 0, 0);
        setTimeout(function() {
            fakeMouseEvent('mousemove', left, top);
            setTimeout(function() {
                fakeMouseEvent('mouseup', left, top);
            }, 0);
        }, 0);
    }
});
    </code></pre>

    <p class="meta">
    posted <span class="posted">2012-09-19</span>
    </p>

</article>


    <script src="/media/jquery-1.6.2.js"></script>
    <script src="/media/twist.js"></script>
    <script type="text/javascript">
      var _gauges = _gauges || [];
      (function() {
        var t   = document.createElement('script');
        t.type  = 'text/javascript';
        t.async = true;
        t.id    = 'gauges-tracker';
        t.setAttribute('data-site-id', '4f408abc844d524b45000062');
        t.src = '//secure.gaug.es/track.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(t, s);
      })();
    </script>
  </body>
</html>